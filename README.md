This repository contains the code for the Cambridge Element Book "Who follows whom? The Role of Geography and Similarity in Online Attention Networks". All files are Jupyter Notebooks, except to python scripts with functions that are used in the notebooks. 

- `Build_network.ipynb` contains the code to construct the follower network from the raw follower data, match it to the voter file and to the other sources of node and edge attributes (census tract RUCA and population density and number of election tweets), pre-process the attributes, calculate the distance between each edge, and add population in the radius from the `Radiation_model.ipynb` notebook. The output is a pickle file, `follower_graph.pk`, which is the pickled version of a NetworkX object, the input of all the other notebooks. 
- `Descriptives.ipynb` outputs the sample composition and average degrees for Table 1, and the degree distribution plots of Appendix 11.   
- `Radiation_model.ipynb` calculates the population in the radius between each edge in the network, and between random samples of dyads. The values between random samples of dyads are saved as `radiation_pop_rand_labels.pk` and `radiation_pop_rand_labels_2.pk` files.
- `Network_Composition.ipynb` calculates and plots the results on ego network composition, displayed in Sections 3.1 and 4.1. 
-  `Bivariate_analysis.ipynb` contains the bivariate analysis with probabilities of a tie, particularly, those with categorical variables (used in Sections 3.2, 4.1 and 4.2, and in Appendices 3, 4, 6, 7, and 10). 
-  `two_variable_heatmaps.ipynb` plots the trivariate heatmaps broken down by population in radius of Section 4.3 and Appendix 8 and the heatmaps of partisanship by election tweets of Appendix 5.
-  `homophily_functions.py` has functions doing the bulk of the calculations in `Network_Composition.ipynb`, `Bivariate_analysis.ipynb`, and `two_variable_heatmaps.ipynb`.
-  `Logistic.ipynb` and `logistic_func.py` contain the code for the bivariate logistic regressions with age, distance, and population in radius (Sections 3.2 and 4.1), and for the multivariate logistic regressions (Section 5 and Appendix 4) and the KHB method (Appendix 9).
-  `CSP_data.ipynb` pre-processes the Covid States survey data and network, and matches with the voter file data to run the comparison of Appendix 1. `CSP_homophily.ipynb` runs the homophily results with the Covid States data of Appendix 2. 
